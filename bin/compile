#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir> <env-dir>

BUILD_DIR=${1:-}
CACHE_DIR=${2:-}
ENV_DIR=${3:-}

# Create private key file
git clone https://github.com/sobolevn/git-secret.git git-secret
cd git-secret && make build
PREFIX="/usr/local" make install
echo $GPG_PRIVATE_KEY > $BUILD_DIR/private_key.gpg
# Import private key
gpg --import $BUILD_DIR/private_key.gpg
# Reveal secrets
git secret reveal
